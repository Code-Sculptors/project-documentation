## Диаграммы состояний (State Diagram)

###### 1. Состояние пользователя
```mermaid

stateDiagram-v2
    [*] --> Гость
    Гость --> Зарегистрирован : Регистрация
    Гость --> Авторизован : Вход
    
    state Зарегистрирован {
        [*] --> Ожидает_активации
        Ожидает_активации --> Активен : Подтверждение email
    }
    
    Авторизован --> В_конференции : Присоединиться
    Авторизован --> [*] : Выход
    
    state В_конференции {
        [*] --> Активный
        Активный --> Приглушенный : Выключить микрофон
        Приглушенный --> Активный : Включить микрофон
        Активный --> Демонстрация : Показать экран
        Демонстрация --> Активный : Остановить демонстрацию
    }
    
    В_конференции --> Авторизован : Покинуть конференцию
```
##### 2. Состояние конференции
```mermaid
stateDiagram-v2

    [*] --> Неактивная
    Неактивная --> Активная : Организатор начинает
    
    
    state Активная {
        [*] --> Ожидание
        Ожидание --> Идет_встреча : Участники присоединились
        Идет_встреча --> Ожидание : Все участники вышли
    }
    
    Активная --> Завершенная : Организатор завершает
    
    Завершенная --> [*]
```

## Use Case диаграммы 
  
#### Основные возможности

```mermaid
graph LR
    A((Гость)) --> B[Зарегистрироваться]
    A --> C[Войти в систему]
    D((Пользователь)) --> E[Создать конференцию]
    D --> F[Присоединиться к конференции]
    D --> G[Выйти из системы]
    D --> H[Добавить контакт]
    D --> I[Удалить контакт]
    D --> J[Включить/выключить камеру]
    D --> K[Включить/выключить микрофон]
    D --> L[Выбрать устройство ввода]
    D --> M[Демонстрировать экран]
    D --> N[Остановить демонстрацию]
    D --> O[Отправить сообщение в чат]
  
    D --> R[Работать на интерактивной доске]

    D --> T[Добавлять аннотации]
    
  
    
    style B fill:#feeeff
    style C fill:#feeeff
    style E fill:#f0f8ff
    style F fill:#f0f8ff
    style G fill:#f0f8ff
    style H fill:#f0f8ff
    style I fill:#f0f8ff
    style J fill:#e6f7ff
    style K fill:#e6f7ff
    style L fill:#e6f7ff
    style M fill:#e6f7ff
    style N fill:#e6f7ff
    style O fill:#e6f7ff
    
    style R fill:#e6f7ff
	
    style T fill:#f8f8f8
   
```





## Диаграммы последовательностей (Sequence Diagrams)

##### 1. Создание и проведение конференции

```mermaid
sequenceDiagram
    participant O as Организатор
    participant P as Участник
    participant F as Frontend
    participant B as Backend
    participant D as База данных
    participant W as WebRTC сервер
   

    %% Создание комнаты
    O->>F: Создает конференцию
    F->>B: POST /api/rooms
    alt Ошибка авторизации
        B-->>F:HTTP 500 - Internal Server Error
        F-->>O: "Требуется вход в систему"
    else Успех
	    B-->>D: Сохранение комнаты
	    B->>B: Генерация URL комнаты
        B-->>F: Данные комнаты
        F-->>O: Ссылка приглашения
    end
    
    %% Присоединение участника
    P->>F: Переходит по ссылке
    F->>B: GET /api/rooms/{id}
    alt Комната не существует
        B-->>F: HTTP 500 - Internal Server Error
        F-->>P: "Комната не найдена"
    else Успех
        B-->>F: Данные комнаты
        F->>W: WebRTC подключение
        W-->>F: Установка медиапотока
        F-->>P: Успешное присоединение
    end
```

##### 2. Взаимодействие в конференции
```mermaid

sequenceDiagram
    participant U1 as Пользователь 1
    participant U2 as Пользователь 2
    participant F1 as Frontend U1
    participant F2 as Frontend U2
    participant W as WebRTC сервер
    participant B as Backend
    
    U1->>F1: Включает демонстрацию экрана
    F1->>W: Отправка видеопотока
    W->>F2: Трансляция потока U2
    F2-->>U2: Отображение экрана U1
    
    U1->>F1: Отправляет сообщение в чат
    F1->>B: POST /api/chat/message
    B->>B: Сохранение сообщения
    B->>F2: WebSocket сообщение
    F2-->>U2: Отображение нового сообщения
    
    U2->>F2: Выключает микрофон
    F2->>W: Остановка аудиопотока
    W->>F1: Обновление статуса U2
    F1-->>U1: Отображение "микрофон выключен"
```

##### 3. Работа с интерактивной доской


```mermaid
sequenceDiagram
    participant U as Участник
    participant F as Frontend
    participant B as Backend
    participant W as WebRTC/WebSocket
 

    U->>F: Открывает доску Excalidraw
    F->>B: GET /api/room/{id}/whiteboard
    B-->>F: Состояние доски
    F-->>U: Отображение интерфейса доски
    
    U->>F: Редактирование доски
    F->>W: Отправка данных элемента
   
    F->>B: POST /api/whiteboard/element
    B->>B: Сохранение элемента
    
```


##### 4. Добавление  пользователя в контакты


```mermaid
sequenceDiagram
    participant U as Пользователь
    participant F as Frontend
    participant B as Backend
    participant DB as База данных

    %% Добавление контакта
    U->>F: Добавляет контакт
    F->>B: POST /api/contacts/add
    B->>DB: Проверка существования пользователя
    alt Пользователь не найден
        DB-->>B: Пользователь не существует
        B-->>F: HTTP 500 - Internal Server Error
        F-->>U: "Пользователь не существует"
    else Пользователь найден
        B->>DB: Проверка существования контакта
        alt Контакт уже есть
            DB-->>B: Контакт существует
            B-->>F: HTTP 500 - Internal Server Error
            F-->>U: "Контакт уже добавлен"
        else Можно добавить
            DB-->>B: Можно добавить
            B->>DB: Создание записи контакта
            DB-->>B: Успешное сохранение
            B-->>F: HTTP 201 - Created
            F-->>U: "Контакт добавлен"
        end
    end

    %% Просмотр контактов
    U->>F: Открывает список контактов
    F->>B: GET /api/contacts
    B->>DB: Получение списка контактов
    DB-->>B: Данные контактов
    B-->>F: Список контактов
    F-->>U: Отображение контактов
```


